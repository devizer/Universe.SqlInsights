variables:
  Project: 'Universe.SqlInsights'
  TEST_W3API: true
  # Default image
  VMIMAGE: 'windows-2019'

jobs:

  - job: If
    strategy:
      maxParallel: 9
      matrix:

        "v2008 R2":
          SQL: 'SqlServer 2008R2 Express: MSSQLSERVER'
          MSI_DUMP: true
        "v2008":
          SQL: 'SqlServer 2008 Express: MSSQLSERVER'
        "v2005":
          SQL: 'SqlServer 2005 Express: MSSQLSERVER'
        
        # VMIMAGE: 'windows-2016' does not exist
        
        "v2008 R2 on Windows Server 2022":
          SQL: 'SqlServer 2008R2 Express: MSSQLSERVER'
          MSI_DUMP: true
          VMIMAGE: 'windows-2022'
          UNINSTALL_TRASH: True
        "v2008 on Windows Server 2022":
          SQL: 'SqlServer 2008 Express: MSSQLSERVER'
          VMIMAGE: 'windows-2022'
          UNINSTALL_TRASH: True
        "v2005 on Windows Server 2022":
          SQL: 'SqlServer 2005 Express: MSSQLSERVER'
          VMIMAGE: 'windows-2022'
          UNINSTALL_TRASH: True
        
        'v2022 Dev':
          SQL: 'SqlServer 2022 Developer: MSSQLSERVER'
          TEST_ADVENTURE_WORKS: true
        "v2019 Dev":
          SQL: 'SqlServer 2019 Developer: MSSQLSERVER'
          TEST_ADVENTURE_WORKS: true
        "v2012":
          SQL: 'SqlServer 2012 Express: MSSQLSERVER'

        "v2014":
          SQL: 'SqlServer 2014 Express: MSSQLSERVER'
          TEST_ADVENTURE_WORKS: true
        "v2017 Dev":
          SQL: 'SqlServer 2017 Developer: MSSQLSERVER'
          TEST_ADVENTURE_WORKS: true
        "v2016":
          SQL: 'SqlServer 2016 Express: MSSQLSERVER'
          TEST_ADVENTURE_WORKS: true
        "v2017":
          SQL: 'SqlServer 2017 Express: MSSQLSERVER'
          TEST_ADVENTURE_WORKS: true

    variables:
      OS: Windows
      # SQL: 'SqlServer 2019 Developer: MSSQLSERVER'
    timeoutInMinutes: 40
    cancelTimeoutInMinutes: 1
    pool:
      vmImage: "$(VMIMAGE)"
    steps:
      - template: azure-steps-win.yml

trigger:
  batch: false
  branches:
    include:
      - main

